generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["nativeTypes"]
}

datasource db {
  provider = "mysql"
  url      = env("LOCAL_DATABASE_URL")
}

///
model Webtoon {
  description String?      @db.Text
  id          String       @id @db.VarChar(191)
  isAdult     Boolean      @db.TinyInt
  isFinish    Boolean      @db.TinyInt
  isPay       Boolean      @db.TinyInt
  platform    Platform
  thumbnail   String       @db.VarChar(191)
  title       String       @db.VarChar(191)
  url         String       @db.VarChar(191)
  comments    Comment[]
  authors     Author[]
  collections Collection[]
  genres      Genre[]
}

model Author {
  id       String    @id @db.VarChar(191)
  name     String    @db.VarChar(191)
  webtoons Webtoon[]
}

model Genre {
  code     String    @id @db.VarChar(191)
  name     String    @db.VarChar(191)
  webtoons Webtoon[]
}

model Collection {
  createdAt   DateTime       @default(now()) @db.Datetime(0)
  description String         @db.Text
  id          String         @id @db.VarChar(191)
  title       String         @db.VarChar(191)
  updatedAt   DateTime       @default(now()) @db.Datetime(3)
  writerId    String         @db.VarChar(191)
  type        CollectionType @default(Public)
  writer      User           @relation(fields: [writerId], references: [id])
  comments    Comment[]
  webtoons    Webtoon[]

  @@index([writerId], name: "writerId")
}

model User {
  email       String       @unique @db.VarChar(191)
  id          String       @id @db.VarChar(191)
  name        String       @db.VarChar(191)
  password    String       @db.VarChar(191)
  collections Collection[]
  commnets    Comment[]
}

model Comment {
  commentId    String?     @db.VarChar(191)
  id           String      @id @db.VarChar(191)
  message      String      @db.VarChar(191)
  webtoonId    String?     @db.VarChar(191)
  writerId     String?     @db.VarChar(191)
  createdAt    DateTime    @default(now()) @db.Datetime(0)
  collectionId String?     @db.VarChar(191)
  collection   Collection? @relation(fields: [collectionId], references: [id])
  comment      Comment?    @relation("CommentToComment", fields: [commentId], references: [id])
  webtoon      Webtoon?    @relation(fields: [webtoonId], references: [id])
  writer       User?       @relation(fields: [writerId], references: [id])
  subComments  Comment[]   @relation("CommentToComment")

  @@index([collectionId], name: "collectionId")
  @@index([commentId], name: "commentId")
  @@index([webtoonId], name: "webtoonId")
  @@index([writerId], name: "writerId")
}

///
enum Platform {
  NAVER
  DAUM
}

enum CollectionType {
  Private
  Public
}
